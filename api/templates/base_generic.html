{% load static %}
{% load api_extras %}
<!DOCTYPE html>
<html lang="en">

<head>
  <!-- JQuery -->
  <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

  <!-- Bootstrap -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
  </script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />

  <!-- Material UI -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

  <!-- Static CSS -->
  <link rel="stylesheet" href="{% static 'tracker/style.css' %}" />
  <link rel="icon" href="{% static 'tracker/favicon.png' %}" />

  <title>
    {% block title %}NHLBI BioData Catalyst | Data Submission Tracker{% endblock %}
  </title>
</head>

<body class="d-flex flex-column min-vh-100">
  <div class="wrapper">
    <nav>
      <div class="side-nav p-2">
        <a href="/">
          <img class="logo" src="{% static 'tracker/bio.svg' %}" alt="BioData Catalyst Logo" />
        </a>
        <hr />
        <div class="list-group">
          <a class="list-group-item list-group-item-action banner-action" href="/">Home</a>
          <a class="list-group-item list-group-item-action banner-action" href="/list">
            Ticket Dashboard
          </a>
          <a class="list-group-item list-group-item-action banner-action" href="/create">
            Create Ticket
          </a>
          <hr />
          <a class="list-group-item list-group-item-action banner-action" href="/custodian_instructions">
            Data Custodian Instructions
          </a>
          <a class="list-group-item list-group-item-action banner-action" href="/user_docs">
            User Documentation
          </a>
        </div>
        <hr />
          {% if user.is_authenticated %}
        <div class="list-group-item list-group-item-success d-column text-center banner-action">
          <strong>{{ user.name }}</strong><br/>
          <strong>{{ user.email }}</strong>
          <br>
          {% if request.path != "/accounts/logout/" %}
          <a href="/accounts/logout" class="btn btn-danger btn-md banner-action w-50" role="button"
             style="padding-left: 0; padding-right: 0;"
              >
            Logout
          </a>
        </div>          
          {% endif %}
          {% endif %}
      </div>
    </nav>

    <main>
      <div id="content">
        {%comment%}
        We set the z-index for the toasts to a very large number so that it appears in front of everything else.
        It's not ideal but it seems that some pages are misusing the bootstrap defined zindex-tooltip and we want
        toast messages to appear in front of everything else.
        {%endcomment%}
        {% if messages %}
        <div
          class="toast-container position-absolute start-50 translate-middle-x w-50"
          style="z-index:9999999; top: 1%;"
        >
          {% for msg in messages %}
          {% if msg|istoastmessage %}
          <div
            class="toast w-100 bg-{{msg|toastbgcolor}} text-{{msg|toasttxtcolor}}"
            role="alert"
            aria-live="assertive"
            aria-atomic="true"
            data-bs-delay="10000"
          >
            <div class="toast-header">
                <strong class="me-auto text-center">Data Submission Tracker</strong>
              <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
              <p class="text-center">{{msg}}</p>
            </div>
          </div>
          {% endif %}
          {% endfor %}
        </div>
        {% endif %}
        <h1 id="titleHeader" class="display-4">Data Submission Tracker</h1>
        {% block content %}{% endblock %}
      </div>
    </main>

    <footer id="footer" class="text-center">
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">Privacy Policy</a>
      </span> |
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">Data Sharing Policy</a>
      </span> |
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">Freedom of Information
          Act (FOIA)</a>
      </span> |
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">Accessibility</a>
      </span> |
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">U.S. Department of
          Health & Human Services</a>
      </span> |
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">National Institutes of
          Health</a>
      </span> |
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">National Heart, Lung, and
          Blood Institute</a>
      </span> |
      <span class="footer-item">
        <a href="https://biodatacatalyst.nhlbi.nih.gov/privacy">USA.gov</a>
      </span>
    </footer>
  </div>

  <!-- Tooltip Script -->
  <script>
    var tooltipTriggerList = [].slice.call(
      document.querySelectorAll('[data-bs-toggle="tooltip"]')
    );
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });

    /* Display Toasts */
    var toastElList = [].slice.call(document.querySelectorAll('.toast'));
    var toastList = toastElList.map(function (toastEl) {
      return new bootstrap.Toast(toastEl)
    });
    toastList.map(function (toast) {
      toast.show()
      return toast;
    });

  </script>
</body>

</html>

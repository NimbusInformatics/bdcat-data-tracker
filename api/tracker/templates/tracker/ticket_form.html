{% extends "base_generic.html" %} {% load widget_tweaks %} {% block content %}
<h1 class="text-muted" style="text-align: center">Ticket Item</h1>

<form class="needs-validation pb-5" method="post">
  <div class="row g-2">
    {% csrf_token %}

    <!-- Hidden fields(?) -->
    {% for hidden_field in form.hidden_fields %} {{ hidden_field }} {% endfor %}

    <!-- Right-side util -->
    <div class="col-md-5 col-lg-4 order-md-last">
      <!-- Handle Errors -->
      {% if form.errors %}
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="badge bg-danger rounded-pill"
          >{{ form.errors|length }} Errors</span
        >
        <h6 class="text-muted">Please fix the following errors</h6>
      </h4>
      <ul class="list-group mb-3">
        {% for field in form %} {% if field.errors %}
        <li class="list-group-item d-flex justify-content-between lh-sm">
          <h6 class="my-0">{{ field.label }}</h6>
          {% for error in field.errors %}
          <small class="text-muted">{{ error }}</small>
          {% endfor %}
        </li>
        {% endif %} {% endfor %}
      </ul>
      {% else %} {% if object %}
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="badge bg-danger rounded-pill">Editing Form</span>
      </h4>
      {% else %}
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="badge bg-info rounded-pill">Creating Ticket</span>
      </h4>
      {% endif %} {% endif %}
    </div>

    <!-- Display Form -->
    <div class="col-md-7 col-lg-8 px-3">
      <h4 class="mb-3">Contact Information</h4>
      <div class="row g-3">
        <!-- Name and Email -->
        <div class="col-sm-6">
          <label for="{{ form.name.id_for_label }}" class="form-label"
            >{{ form.name.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.name.auto_id }}"
            name="{{ form.name.name }}"
            placeholder="{{ form.name.label }}"
            value="{{ form.name.value }}"
          />
          <div class="form-text">{{ form.name.help_text }}</div>
        </div>
        <div class="col-sm-6">
          <label for="{{ form.email.id_for_label }}" class="form-label"
            >{{ form.email.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.email.auto_id }}"
            name="{{ form.email.name }}"
            placeholder="{{ form.email.label }}"
            value="{{ form.email.value }}"
          />
        </div>

        <!-- Organization -->
        <div class="col-12">
          <label for="{{ form.organization.id_for_label }}" class="form-label"
            >{{ form.organization.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.organization.auto_id }}"
            name="{{ form.organization.name }}"
            placeholder="{{ form.organization.label }}"
            value="{{ form.organization.value }}"
          />
          <div class="form-text">{{ form.organization.help_text }}</div>
        </div>

        <hr class="my-4" />
      </div>

      <h4 class="mb-3">Study Information</h4>
      <div class="row g-3">
        <!-- Study Name -->
        <div class="col-12">
          <label for="{{ form.study_name.id_for_label }}" class="form-label"
            >{{ form.study_name.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.study_name.auto_id }}"
            name="{{ form.study_name.name }}"
            placeholder="{{ form.study_name.label }}"
            value="{{ form.study_name.value }}"
          />
          <div class="form-text">{{ form.study_name.help_text }}</div>
        </div>

        <!-- Study ID and Consent Code -->
        <div class="col-sm-6">
          <label for="{{ form.study_id.id_for_label }}" class="form-label"
            >{{ form.study_id.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.study_id.auto_id }}"
            name="{{ form.study_id.name }}"
            placeholder="{{ form.study_id.label }}"
            value="{{ form.study_id.value }}"
          />
          <div class="form-text">{{ form.study_id.help_text }}</div>
        </div>
        <div class="col-sm-6">
          <label for="{{ form.consent_code.id_for_label }}" class="form-label"
            >{{ form.consent_code.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.consent_code.auto_id }}"
            name="{{ form.consent_code.name }}"
            placeholder="{{ form.consent_code.label }}"
            value="{{ form.consent_code.value }}"
          />
        </div>
        <hr class="my-4" />
      </div>

      <h4 class="mb-3">Dataset Information</h4>
      <div class="row g-3">
        <!-- Dataset Description -->
        <div class="col-12">
          <label
            for="{{ form.dataset_description.id_for_label }}"
            class="form-label"
            >{{ form.dataset_description.label }}</label
          >
          <textarea
            class="form-control"
            id="{{ form.dataset_description.auto_id }}"
            name="{{ form.dataset_description.name }}"
            placeholder="{{ form.dataset_description.label }}"
            rows="12"
          >
{{ form.dataset_description.value }}</textarea
          >
          <div class="form-text">{{ form.dataset_description.help_text }}</div>
        </div>

        <!-- GMail and AWS-->
        <div class="col-sm-6">
          <label for="{{ form.google_email.id_for_label }}" class="form-label"
            >{{ form.google_email.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.google_email.auto_id }}"
            name="{{ form.google_email.name }}"
            placeholder="{{ form.google_email.label }}"
            value="{{ form.google_email.value }}"
          />
          <div class="form-text">{{ form.google_email.help_text }}</div>
        </div>
        <div class="col-sm-6">
          <label for="{{ form.aws_iam.id_for_label }}" class="form-label"
            >{{ form.aws_iam.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.aws_iam.auto_id }}"
            name="{{ form.aws_iam.name }}"
            placeholder="{{ form.aws_iam.label }}"
            value="{{ form.aws_iam.value }}"
          />
          <div class="form-text">{{ form.aws_iam.help_text }}</div>
        </div>

        <!-- Data Size -->
        <div class="col-sm-4">
          <label for="{{ form.data_size.id_for_label }}" class="form-label"
            >{{ form.data_size.label }}</label
          >
          <input
            type="text"
            class="form-control"
            id="{{ form.data_size.auto_id }}"
            name="{{ form.data_size.name }}"
            placeholder="{{ form.data_size.label }}"
            value="{{ form.data_size.value }}"
          />
          <div class="form-text">{{ form.data_size.help_text }}</div>
        </div>

        <!-- Test Data Checkbox -->
        <div class="col-12">
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="{{form.is_test_data.auto_id }}"
              name="{{ form.is_test_data.name }}"
              {%
              if
              form.is_test_data
              %}
              checked
              {%
              endif
              %}
            />
            <label
              class="form-check-label"
              for="{{ form.is_test_data.id_for_label }}"
              >{{ form.is_test_data.help_text }}</label
            >
          </div>
        </div>
        <hr class="my-4" />
      </div>

      <!-- Handle Create/Update Buttons -->
      <div class="row">
        {% if object %}
        <input class="btn btn-primary btn-lg" type="submit" value="Update" />
        <a
          href="{% url 'tracker:ticket-delete' pk=object.pk %}"
          class="btn btn-cancel btn-lg"
          role="button"
          >Delete Ticket</a
        >
        {% else %}
        <input
          class="col btn btn-primary btn-lg"
          type="submit"
          value="Submit"
        />
        {% endif %}
      </div>
    </div>
  </div>
</form>

<!-- DEBUG -->
<!-- {{ form.as_table }} -->
{% endblock %}
